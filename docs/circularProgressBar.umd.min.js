!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).CircularProgressBar=e()}(this,(function(){"use strict";function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const e={colorCircle:"",colorSlice:"#00a1ff",end:264,fontColor:"#000",fontSize:"1.6rem",fontWeight:400,lineargradient:!1,number:!0,round:!1,fill:"none",unit:"%",rotation:-90,opacity:10,size:200,stroke:10};return class{constructor(i){t(this,"initial",(t=>{if("IntersectionObserver"in window){const e=new IntersectionObserver(((t,e)=>{t.map((t=>{t.isIntersecting&&t.intersectionRatio>.75&&(this.elSVG(t.target),e.unobserve(t.target))}))}),{root:null,rootMargin:"0px",threshold:1});t.map((t=>{e.observe(t)}))}else t.map((t=>{this.elSVG(t)}))})),t(this,"progress",((t,e,i)=>{i.number&&t.insertAdjacentElement("beforeend",this.percent(i));const r=document.querySelector(`.${this.pieName}-circle-${i.index}`),n={fill:"none","stroke-width":i.stroke,"stroke-dasharray":"264","stroke-linecap":i.round?"round":""};this.attr(r,n),this.animationTo({...i,element:r},!0),r.setAttribute("style",`transform:rotate(${i.rotation}deg);transform-origin: 50% 50%`),this.color(r,i),e.setAttribute("style",`width:${i.size}px;height:${i.size}px;`)})),t(this,"color",((t,{lineargradient:e,index:i,colorSlice:r})=>{t.setAttribute("stroke",e?`url(#linear-${i})`:r)})),t(this,"dashOffset",((t,e,i)=>{const r=264-t/100*(i?2.64*(100-i):264);return e?-r:r})),t(this,"animationTo",((t,i=!1)=>{const r=JSON.parse(document.querySelector(`[data-pie-index="${t.index}"]`).getAttribute("data-pie")),n=document.querySelector(`.${this.pieName}-circle-${t.index}`);if(!n)return;const s=i?t:{...e,...r,...t};if(i||this.color(n,s),!i&&s.number){const t={fill:s.fontColor,"font-size":s.fontSize,"font-weight":s.fontWeight},e=document.querySelector(`.${this.pieName}-text-${s.index}`);this.attr(e,t)}const o=document.querySelector(`.${this.pieName}-percent-${t.index}`);if(s.animationOff)return s.number&&(o.textContent=""+s.percent),void n.setAttribute("stroke-dashoffset",this.dashOffset(s.percent,s.inverse));let a=JSON.parse(n.getAttribute("data-angel"));const c=Math.round(t.percent);if(0==c&&(s.number&&(o.textContent="0"),n.setAttribute("stroke-dashoffset","264")),c>100||c<=0||a===c)return;let l,d=i?0:a;const h=1e3/(s.speed||1e3);let u=performance.now();const f=t=>{l=requestAnimationFrame(f);const e=t-u;e>=h-.1&&(u=t-e%h,a>=s.percent?d--:d++),n.setAttribute("stroke-dashoffset",this.dashOffset(d,s.inverse,s.cut)),o&&s.number&&(o.textContent=""+d),d===c&&(n.setAttribute("data-angel",d),cancelAnimationFrame(l))};requestAnimationFrame(f)})),t(this,"percent",(t=>{const e=this.creNS("text");e.classList.add(`${this.pieName}-text-${t.index}`),e.insertAdjacentElement("afterbegin",this.tspan(`${this.pieName}-percent-${t.index}`)),e.insertAdjacentElement("beforeend",this.tspan(`${this.pieName}-unit-${t.index}`,t.unit));const i={x:"50%",y:"50%",fill:t.fontColor,"font-size":t.fontSize,"font-weight":t.fontWeight,"text-anchor":"middle",dy:t.textPosition||"0.35em"};return this.attr(e,i),e})),t(this,"tspan",((t,e)=>{const i=this.creNS("tspan");return i.classList.add(t),e&&(i.textContent=e),i})),t(this,"elSVG",(t=>{const i=t.getAttribute("data-pie-index"),r=JSON.parse(t.getAttribute("data-pie")),n={...e,...r,index:i},s=this.creNS("svg"),o={role:"img",width:n.size,height:n.size,viewBox:"0 0 100 100"};this.attr(s,o),n.colorCircle&&s.appendChild(this.circle(n,"bottom")),n.lineargradient&&s.appendChild(this.gradient(n)),s.appendChild(this.circle(n,"top",!0)),t.appendChild(s),this.progress(s,t,n)})),t(this,"gradient",(({index:t,lineargradient:e})=>{const i=this.creNS("defs"),r=this.creNS("linearGradient");r.id="linear-"+t;const n=[].slice.call(e);i.appendChild(r);let s=0;return n.map((t=>{const e=this.creNS("stop"),i={offset:s+"%","stop-color":""+t};this.attr(e,i),r.appendChild(e),s+=100/(n.length-1)})),i})),t(this,"circle",((t,e,i=!1)=>{const r=this.creNS("circle");let n={};if(t.cut){const e=264-2.64*(100-t.cut);n={"stroke-dasharray":"264","stroke-linecap":t.round?"round":"","stroke-dashoffset":t.inverse?-e:e,style:`transform:rotate(${t.rotation}deg);transform-origin: 50% 50%`}}const s={fill:t.fill,stroke:t.colorCircle,"stroke-width":t.strokeBottom||t.stroke,...n};t.strokeDasharray&&Object.assign(s,{"stroke-dasharray":t.strokeDasharray});const o={cx:"50%",cy:"50%",r:42,"shape-rendering":"geometricPrecision","data-angle":i?0:"",..."top"===e?{class:`${this.pieName}-circle-${t.index}`}:s};return this.attr(r,o),r})),t(this,"creNS",(t=>document.createElementNS(this.svg,t))),t(this,"attr",((t,e)=>{for(const i in e)null==t||t.setAttribute(i,e[i])})),this.pieName=i,this.svg="http://www.w3.org/2000/svg";const r=document.querySelectorAll("."+i),n=[].slice.call(r);n.map(((t,e)=>{t.setAttribute("data-pie-index",e+1)})),this.initial(n)}}}));
